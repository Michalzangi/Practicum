<!DOCTYPE html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>practicum</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Free HTML5 Template by FREEHTML5.CO" />
    <meta name="keywords" content="free html5, free template, free bootstrap, html5, css3, mobile first, responsive" />
    <meta name="author" content="FREEHTML5.CO" />

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="favicon.ico">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,300' rel='stylesheet' type='text/css'>

    <!-- Animate.css -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <!-- Superfish -->
    <link rel="stylesheet" href="css/superfish.css">
    <!-- Flexslider  -->
    <link rel="stylesheet" href="css/flexslider.css">
    <!-- Magnific Popup -->
    <link rel="stylesheet" href="css/magnific-popup.css">
    <!-- Date Picker -->
    <link rel="stylesheet" href="css/bootstrap-datepicker.min.css">
    <!-- CS Select -->
    <link rel="stylesheet" href="css/cs-select.css">
    <link rel="stylesheet" href="css/cs-skin-border.css">

    <link rel="stylesheet" href="css/style.css">

    <!-- Modernizr JS -->
    <script src="js/modernizr-2.6.2.min.js"></script>

    <style>
	
        .user-row {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 5px;
        }
        /* Header styling */
        .users-header {
            text-align: center;
            margin-bottom: 30px;
        }

    </style>

</head>
<body>
<div id="fh5co-wrapper">
    <div id="fh5co-page">
        <header id="fh5co-header-section" class="sticky-banner">
            <div class="container">
                <div class="nav-header">
                    <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle dark"><i></i></a>
                    <h1 id="fh5co-logo"><a href="HomeManager.html"><i class="icon-home"></i> Heh Bâ€™iyar <span> Real Estate</span></a></h1>
                    <!-- START #fh5co-menu-wrap -->
                    <nav id="fh5co-menu-wrap" role="navigation">
                        <ul class="sf-menu" id="fh5co-primary-menu">
                            <li><a href="HomeManager.html">Home</a></li>
                            <li>
                                <a href="AssetsManager.html" class="fh5co-sub-ddown">Assets</a>
                                <ul class="fh5co-sub-menu">
                                    <li><a href="#">New</a></li>
                                    <li><a href="#">Discount</a></li>
                                    <li><a href="#">Sale</a></li>
                                    <li><a href="#">Rent</a></li>
                                    <li><a href="#">All</a></li>
                                </ul>
                            </li>
                            <li><a href="Manager.html">Manager</a></li>
                            <li><a href="BlogManager.html">Blog</a></li>
                            <li><a href="AddManager.html">Add</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>

        <aside id="fh5co-hero" class="js-fullheight">
            <div class="flexslider js-fullheight">
                <ul class="slides">
                    <li style="background-image: url(images/cov.png);">
                        <div class="overlay"></div>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-8 col-md-offset-2 text-center js-fullheight slider-text">
                                    <div class="slider-text-inner">
                                        <h2 class="heading-title">Manager</h2>
                                        <p class="fh5co-lead"> Coming Soon <i class="icon-heart3"></i> </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </aside>

		<div id="fh5co-blog-section" class="fh5co-section-gray">
            <div class="container">
				<h2 class="users-header">Users</h2>
				<div id="users-container"></div>
				<form id="add-user-form" class="user-row">
					<h2>Add New User</h2>
					<div class="form-group">
						<label for="username">Username:</label>
						<input type="text" id="username" name="username" required class="centered">
					</div>
					<div class="form-group">
						<label for="password">Password:</label>
						<input type="password" id="password" name="password" required class="centered">
					</div>
					<div class="form-group">
						<label for="role">Role:</label>
						<select id="role" name="role" required class="centered">
							<option value="administrator">Admin</option>
							<option value="user">User</option>
						</select>
					</div>
					<button type="submit" class="btn btn-primary">Add User</button><br>
				</form>
			</div>
			

        <footer>
            <div id="footer">
                <div class="container">
                    <div class="row row-bottom-padded-md">
                        <div class="col-md-3">
                            <h3 class="section-title">About Us</h3>
                            <p>We, Bar Michal and Nofar, information systems management students at the College of Management, own all the exclusive rights to this website <i class="icon-heart3"></i></p>
                        </div>

                        <div class="col-md-3 col-md-push-1">
                            <h3 class="section-title">Links</h3>
                            <ul>
                                <li><a href="#">Home</a></li>
                                <li><a href="#">Assets</a></li>
                                <li><a href="#">Agent</a></li>
                                <li><a href="#">Blog</a></li>
                                <li><a href="#">Contact</a></li>
                            </ul>
                        </div>

                        <div class="col-md-3">
                            <h3 class="section-title">Information</h3>
                            <ul>
                                <li><a href="#">Terms &amp; Condition</a></li>
                                <li><a href="#">License</a></li>
                                <li><a href="#">Privacy &amp; Policy</a></li>
                                <li><a href="#">Contact Us</a></li>
                            </ul>
                        </div>
                        <div class="col-md-3">
                            <h3 class="section-title">Newsletter</h3>
                            <p>Subscribe for our newsletter</p>
                            <form class="form-inline" id="fh5co-header-subscribe">
                                <div class="row">
                                    <div class="col-md-12 col-md-offset-0">
                                        <div class="form-group">
                                            <input type="text" class="form-control" id="email" placeholder="Enter your email">
                                            <button type="submit" class="btn btn-default"><i class="icon-paper-plane"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <p class="fh5co-social-icons">
                                <a href="#"><i class="icon-twitter2"></i></a>
                                <a href="#"><i class="icon-facebook2"></i></a>
                                <a href="#"><i class="icon-instagram"></i></a>
                                <a href="#"><i class="icon-dribbble2"></i></a>
                                <a href="#"><i class="icon-youtube"></i></a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
</div>

<script src="js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<script src="js/sticky.js"></script>
<!-- Superfish -->
<script src="js/hoverIntent.js"></script>
<script src="js/superfish.js"></script>
<!-- Flexslider -->
<script src="js/jquery.flexslider-min.js"></script>
<!-- Date Picker -->
<script src="js/bootstrap-datepicker.min.js"></script>
<!-- CS Select -->
<script src="js/classie.js"></script>
<script src="js/selectFx.js"></script>
<script src="js/main.js"></script>
<script>
	window.onload = async () => {
		try {
			const response = await fetch('/Users');
			const users = await response.json(); // Corrected variable name
			const usersContainer = document.getElementById('users-container');
			
			// Clear the existing content in case it's already populated
			usersContainer.innerHTML = '';
	
			users.forEach(user => {
				// Create a div element for each user with the user-row class
				const userElement = document.createElement('div');
				userElement.classList.add('user-row'); // Add user-row class
				userElement.innerHTML = `
					<p>Id: ${user._id}</p>
					<p>Username: ${user.UserName}</p>
					<p>Password: ${user.Password}</p>
					<p>Role: ${user.Role}</p>
					<button class="delete-btn" style="background-color: pink;" data-id="${user._id}">Delete</button>
				`;
				usersContainer.appendChild(userElement);
			});
	
			// Add event listeners to delete buttons
			const deleteButtons = document.querySelectorAll('.delete-btn');
			deleteButtons.forEach(button => {
				button.addEventListener('click', async () => {
					const userId = button.getAttribute('data-id');
					try {
						const response = await fetch(`/Users/${userId}`, {
							method: 'DELETE'
						});
						if (response.ok) {
							// Remove the user row from the UI
							button.parentElement.remove();
						} else {
							console.error('Failed to delete user');
						}
					} catch (error) {
						console.error('Error deleting user:', error);
					}
				});
			});
		} catch (error) {
			console.error('Error fetching users:', error);
		}
	};
	document.getElementById('add-user-form').addEventListener('submit', async function(event) {
        event.preventDefault(); 
        const formData = new FormData(this);
        const newUser = {};
        formData.forEach((value, key) => {
            newUser[key] = value;
        });

        try {
            const response = await fetch('/Users', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(newUser)
            });
            if (response.ok) {
                const addedUser = await response.json();
                // Add the new user to the UI
                addUserToUI(addedUser);
                // Clear form fields
                this.reset();
            } else {
                console.error('Failed to add user');
            }
        } catch (error) {
            console.error('Error adding user:', error);
        }
    });

    // Function to add a user to the UI
    function addUserToUI(user) {
        const usersContainer = document.getElementById('users-container');
        const userElement = document.createElement('div');
        userElement.classList.add('user-row');
        userElement.innerHTML = `
            <p>Id: ${User._id}</p>
            <p>Username: ${User.UserName}</p>
            <p>Password: ${User.Password}</p>
            <p>Role: ${User.Role}</p>
            <button class="delete-btn" style="background-color: pink;" data-id="${user._id}">Delete</button>
        `;
        usersContainer.appendChild(userElement);

        // Add event listener to delete button
        userElement.querySelector('.delete-btn').addEventListener('click', async () => {
            const userId = user._id;
            try {
                const response = await fetch(`/Users/${userId}`, {
                    method: 'DELETE'
                });
                if (response.ok) {
                    userElement.remove(); // Remove the user row from the UI
                } else {
                    console.error('Failed to delete user');
                }
            } catch (error) {
                console.error('Error deleting user:', error);
            }
        });
    }
	</script>
</body>
</html>
